# 2026-01-28

## [14:30] account-settings — add unsaved changes indicator and confirmation
- **Files:** `components/settings/*-form.tsx`, `components/settings/account-settings-tabs.tsx`, `app/(dashboard)/settings/account/page.tsx`
- **Why:** Users could lose unsaved changes when switching tabs or navigating away. Added visual indicators and confirmation dialogs to prevent accidental data loss.
- **Commit:** `485fc65`

## [16:23] account-settings — apply theme changes immediately
- **Files:** `components/settings/preferences-form.tsx`
- **Why:** Fulfill US-21.3 requirement for immediate theme application. Theme now changes instantly when user selects it, while still requiring save to persist to database.
- **Commit:** `6309327`

## [16:25] account-settings — add reactive form synchronization
- **Files:** `components/settings/profile-form.tsx`, `components/settings/preferences-form.tsx`, `components/settings/user-notifications-form.tsx`
- **Why:** Forms need to sync when user data changes externally via Convex's reactive updates (e.g., from another tab/session). Added useEffect to detect changes and update form values only when form is not dirty.
- **Commit:** `d3795fc`

## [17:30] dx — document optimized form loading states pattern
- **Files:** `docs/patterns/form-loading-states.md`
- **Why:** Verified that all settings forms already implement optimal loading states (non-blocking UX with button-only loading indicator). Documented the pattern for consistency and future reference.
- **Commit:** `449bb7d`

## [16:28] account-settings — add email immutability validation in backend
- **Files:** `convex/users.ts`
- **Why:** Add security layer to prevent email modification in updateProfile mutation. Although frontend marks email as read-only, backend must validate this to prevent runtime attempts to modify the email field.
- **Commit:** `1d2980d`

## [16:55] ui — fix lucide-react icon imports for build
- **Files:** `components/inventory/product-combobox.tsx`, `components/products/product-list.tsx`, `components/products/product-table.tsx`
- **Why:** Build was failing because Plant, Seedling, and Tree icons don't exist in lucide-react v0.454.0. Replaced with Sprout icon for plant-related product categories.
- **Commit:** `72dbd73`

## [17:04] batches — add batch harvest wizard for US-25.8
- **Files:** `components/batches/batch-harvest-wizard.tsx`
- **Why:** Implement multi-step wizard to guide users through harvesting batches, recording yield data, and creating inventory items. Includes harvest details (quantity, date, quality grade), inventory creation (product selection, storage location), and confirmation with batch status transition to "harvested".
- **Commit:** `5ee342b`

## [18:15] batches — complete M25 batch operations implementation
- **Files:** `components/batches/batch-split-wizard.tsx`, `components/batches/batch-loss-modal.tsx`, `components/batches/batch-merge-modal.tsx`, `components/batches/batch-archive-modal.tsx`, `components/batches/batch-card.tsx`, `app/(dashboard)/batches/[id]/page.tsx`
- **Why:** M25 audit revealed 6 missing operation UIs (US-25.4 to US-25.9). Implemented all 5 remaining modal components: split wizard (multi-step with quantity distribution and metadata), loss recording (with high-loss warnings), merge selection (compatible batches only), archive confirmation (destructive action), and connected all modals to batch card dropdown menu and detail page action buttons. Module now functionally complete with full batch lifecycle management.
- **Commit:** `98ce8cd`, `f3e0d52`, `b0e0f34`, `2530e1b`, `24e43a6`
